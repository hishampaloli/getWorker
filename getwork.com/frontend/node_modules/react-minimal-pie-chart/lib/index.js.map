{"version":3,"file":"index.js","sources":["../src/utils.ts","../src/Chart/extendData.ts","../src/Label.tsx","../src/Chart/renderLabels.tsx","../node_modules/svg-partial-circle/index.js","../src/Path.tsx","../src/Chart/renderSegments.tsx","../src/Chart/Chart.tsx"],"sourcesContent":["export function degreesToRadians(degrees: number) {\n  return (degrees * Math.PI) / 180;\n}\n\nexport function valueBetween(value: number, min: number, max: number) {\n  if (value > max) return max;\n  if (value < min) return min;\n  return value;\n}\n\nexport function extractPercentage(value: number, percentage: number) {\n  return (percentage / 100) * value;\n}\n\nexport function bisectorAngle(startAngle: number, lengthAngle: number) {\n  return startAngle + lengthAngle / 2;\n}\n\nexport function shiftVectorAlongAngle(angle: number, distance: number) {\n  const angleRadians = degreesToRadians(angle);\n  return {\n    dx: distance * Math.cos(angleRadians),\n    dy: distance * Math.sin(angleRadians),\n  };\n}\n\nexport function isNumber(value: unknown): value is number {\n  return typeof value === 'number';\n}\n\nexport function functionProp<Prop, Payload>(\n  prop: Prop,\n  payload?: Payload\n): Prop extends (...args: any) => any ? ReturnType<Prop> : Prop {\n  return typeof prop === 'function' ? prop(payload) : prop;\n}\n","import { extractPercentage, valueBetween } from '../utils';\nimport type { Data, ExtendedData } from '../commonTypes';\nimport type { PropsWithDefaults as ChartProps } from './Chart';\n\nfunction sumValues(data: Data): number {\n  let sum = 0;\n  for (let i = 0; i < data.length; i++) {\n    sum += data[i].value;\n  }\n  return sum;\n}\n\n// Append \"percentage\", \"degrees\" and \"startAngle\" to each data entry\nexport default function extendData({\n  data,\n  lengthAngle: totalAngle,\n  totalValue,\n  paddingAngle,\n  startAngle: chartStartAngle,\n}: ChartProps): ExtendedData {\n  const total = totalValue || sumValues(data);\n  const normalizedTotalAngle = valueBetween(totalAngle, -360, 360);\n  const numberOfPaddings =\n    Math.abs(normalizedTotalAngle) === 360 ? data.length : data.length - 1;\n  const singlePaddingDegrees = Math.abs(paddingAngle) * Math.sign(totalAngle);\n  const degreesTakenByPadding = singlePaddingDegrees * numberOfPaddings;\n  const degreesTakenByPaths = normalizedTotalAngle - degreesTakenByPadding;\n  let lastSegmentEnd = 0;\n  const extendedData = [];\n\n  // @NOTE: Shall we evaluate percentage accordingly to dataEntry.value's sign?\n  for (let i = 0; i < data.length; i++) {\n    const dataEntry = data[i];\n    const valueInPercentage = total === 0 ? 0 : (dataEntry.value / total) * 100;\n    const degrees = extractPercentage(degreesTakenByPaths, valueInPercentage);\n    const startAngle = lastSegmentEnd + chartStartAngle;\n    lastSegmentEnd = lastSegmentEnd + degrees + singlePaddingDegrees;\n    extendedData.push(\n      Object.assign(\n        {\n          percentage: valueInPercentage,\n          startAngle,\n          degrees,\n        },\n        dataEntry\n      )\n    );\n  }\n  return extendedData;\n}\n","import React from 'react';\nimport type { CSSProperties, SVGProps } from 'react';\nimport type { ExtendedDataEntry } from './commonTypes';\n\nexport type LabelRenderProps = {\n  x: number;\n  y: number;\n  dx: number;\n  dy: number;\n  textAnchor: string;\n  dataEntry: ExtendedDataEntry;\n  dataIndex: number;\n  style?: CSSProperties;\n};\n\ntype Props = SVGProps<SVGTextElement> & LabelRenderProps;\n\nexport default function ReactMinimalPieChartLabel({\n  dataEntry,\n  dataIndex,\n  ...props\n}: Props) {\n  return <text dominantBaseline=\"central\" {...props} />;\n}\n","import React from 'react';\nimport DefaultLabel from '../Label';\nimport {\n  bisectorAngle,\n  extractPercentage,\n  functionProp,\n  shiftVectorAlongAngle,\n} from '../utils';\nimport type { PropsWithDefaults as ChartProps } from './Chart';\nimport type { LabelRenderProps } from '../Label';\nimport type { ExtendedData, LabelRenderFunction } from '../commonTypes';\n\nfunction round(number: number): number {\n  const divisor = 1e14; // 14 decimals\n  return Math.round((number + Number.EPSILON) * divisor) / divisor;\n}\n\nfunction evaluateTextAnchorPosition({\n  labelPosition,\n  lineWidth,\n  labelHorizontalShift,\n}: {\n  labelPosition: number;\n  lineWidth: number;\n  labelHorizontalShift: number;\n}) {\n  const dx = round(labelHorizontalShift);\n  // Label in the vertical center\n  if (dx === 0) {\n    return 'middle';\n  }\n  // Outward label\n  if (labelPosition > 100) {\n    return dx > 0 ? 'start' : 'end';\n  }\n  // Inward label\n  const innerRadius = 100 - lineWidth;\n  if (labelPosition < innerRadius) {\n    return dx > 0 ? 'end' : 'start';\n  }\n  // Overlying label\n  return 'middle';\n}\n\nfunction renderLabelElement(\n  renderLabel: LabelRenderFunction,\n  labelProps: LabelRenderProps\n): JSX.Element | null {\n  const label = renderLabel(labelProps);\n  if (typeof label === 'string' || typeof label === 'number') {\n    return (\n      <DefaultLabel\n        key={`label-${labelProps.dataEntry.key || labelProps.dataIndex}`}\n        {...labelProps}\n      >\n        {label}\n      </DefaultLabel>\n    );\n  }\n\n  if (React.isValidElement(label)) {\n    return label;\n  }\n  return null;\n}\n\nexport default function renderLabels(data: ExtendedData, props: ChartProps) {\n  return data.map((dataEntry, index) => {\n    const segmentsShift = functionProp(props.segmentsShift, index) ?? 0;\n    const distanceFromCenter =\n      extractPercentage(props.radius, props.labelPosition) + segmentsShift;\n    const { dx, dy } = shiftVectorAlongAngle(\n      bisectorAngle(dataEntry.startAngle, dataEntry.degrees),\n      distanceFromCenter\n    );\n\n    // This object is passed as argument to the \"label\" function prop\n    const labelRenderProps = {\n      x: props.center[0],\n      y: props.center[1],\n      dx,\n      dy,\n      textAnchor: evaluateTextAnchorPosition({\n        labelPosition: props.labelPosition,\n        lineWidth: props.lineWidth,\n        labelHorizontalShift: dx,\n      }),\n      dataEntry,\n      dataIndex: index,\n      style: functionProp(props.labelStyle, index),\n    };\n\n    return props.label && renderLabelElement(props.label, labelRenderProps);\n  });\n}\n","'use strict'\n\n// from http://stackoverflow.com/a/18473154\nconst partialCircle = (cx, cy, r, start, end) => {\n\tconst length = end - start\n\tif (length === 0) return []\n\n\tconst fromX = r * Math.cos(start) + cx\n\tconst fromY = r * Math.sin(start) + cy\n\tconst toX = r * Math.cos(end) + cx\n\tconst toY = r * Math.sin(end) + cy\n\tconst large = Math.abs(length) <= Math.PI ? '0' : '1'\n\tconst sweep = length < 0 ? '0' : '1'\n\n\treturn [\n\t\t['M', fromX, fromY],\n\t\t['A', r, r, 0, large, sweep, toX, toY]\n\t]\n}\n\nmodule.exports = partialCircle\n","import React from 'react';\nimport type { SVGProps } from 'react';\nimport partialCircle from 'svg-partial-circle';\nimport {\n  bisectorAngle,\n  degreesToRadians,\n  extractPercentage,\n  isNumber,\n  shiftVectorAlongAngle,\n  valueBetween,\n} from './utils';\n\nexport function makePathCommands(\n  cx: number,\n  cy: number,\n  startAngle: number,\n  lengthAngle: number,\n  radius: number\n): string {\n  const patchedLengthAngle = valueBetween(lengthAngle, -359.999, 359.999);\n\n  return partialCircle(\n    cx,\n    cy, // center X and Y\n    radius,\n    degreesToRadians(startAngle),\n    degreesToRadians(startAngle + patchedLengthAngle)\n  )\n    .map((command) => command.join(' '))\n    .join(' ');\n}\n\ntype Props = SVGProps<SVGPathElement> & {\n  cx: number;\n  cy: number;\n  lengthAngle: number;\n  lineWidth: number;\n  radius: number;\n  reveal?: number;\n  rounded?: boolean;\n  shift?: number;\n  startAngle: number;\n  title?: string | number;\n};\n\nexport default function ReactMinimalPieChartPath({\n  cx,\n  cy,\n  lengthAngle,\n  lineWidth,\n  radius,\n  shift = 0,\n  reveal,\n  rounded,\n  startAngle,\n  title,\n  ...props\n}: Props) {\n  const pathRadius = radius - lineWidth / 2;\n  //@NOTE This shift might be rendered as a translation in future\n  const { dx, dy } = shiftVectorAlongAngle(\n    bisectorAngle(startAngle, lengthAngle),\n    shift\n  );\n\n  const pathCommands = makePathCommands(\n    cx + dx,\n    cy + dy,\n    startAngle,\n    lengthAngle,\n    pathRadius\n  );\n  let strokeDasharray;\n  let strokeDashoffset;\n\n  // Animate/hide paths with \"stroke-dasharray\" + \"stroke-dashoffset\"\n  // https://css-tricks.com/svg-line-animation-works/\n  if (isNumber(reveal)) {\n    const pathLength = degreesToRadians(pathRadius) * lengthAngle;\n    strokeDasharray = Math.abs(pathLength);\n    strokeDashoffset =\n      strokeDasharray - extractPercentage(strokeDasharray, reveal);\n  }\n\n  return (\n    <path\n      d={pathCommands}\n      fill=\"none\"\n      strokeWidth={lineWidth}\n      strokeDasharray={strokeDasharray}\n      strokeDashoffset={strokeDashoffset}\n      strokeLinecap={rounded ? 'round' : undefined}\n      {...props}\n    >\n      {title && <title>{title}</title>}\n    </path>\n  );\n}\n","import React from 'react';\nimport type { CSSProperties } from 'react';\nimport Path from '../Path';\nimport { extractPercentage, functionProp, isNumber } from '../utils';\nimport type { ExtendedData } from '../commonTypes';\nimport type { PropsWithDefaults as ChartProps } from './Chart';\n\nfunction combineSegmentTransitionsStyle(\n  duration: number,\n  easing: string,\n  customStyle?: CSSProperties\n): { transition: string } {\n  // Merge chart's animation CSS transition with \"transition\" found to customStyle\n  let transition = `stroke-dashoffset ${duration}ms ${easing}`;\n  if (customStyle && customStyle.transition) {\n    transition = `${transition},${customStyle.transition}`;\n  }\n  return {\n    transition,\n  };\n}\n\nfunction getRevealValue<Reveal>(props: { reveal?: Reveal; animate?: boolean }) {\n  //@NOTE When animation is on, chart has to be fully revealed when reveal is not set\n  if (props.animate && !isNumber(props.reveal)) {\n    return 100;\n  }\n  return props.reveal;\n}\n\nfunction makeEventHandler<Event, EventHandler, Payload>(\n  eventHandler: undefined | (EventHandler & Function),\n  payload: Payload\n) {\n  return (\n    eventHandler &&\n    ((e: Event) => {\n      eventHandler(e, payload);\n    })\n  );\n}\n\nexport default function renderSegments(\n  data: ExtendedData,\n  props: ChartProps,\n  revealOverride?: null | number\n) {\n  // @NOTE this should go in Path component. Here for performance reasons\n  const reveal = revealOverride ?? getRevealValue(props);\n  const {\n    radius,\n    center: [cx, cy],\n  } = props;\n  const lineWidth = extractPercentage(radius, props.lineWidth);\n  const paths = data.map((dataEntry, index) => {\n    const segmentsStyle = functionProp(props.segmentsStyle, index);\n    return (\n      <Path\n        cx={cx}\n        cy={cy}\n        key={dataEntry.key || index}\n        lengthAngle={dataEntry.degrees}\n        lineWidth={lineWidth}\n        radius={radius}\n        rounded={props.rounded}\n        reveal={reveal}\n        shift={functionProp(props.segmentsShift, index)}\n        startAngle={dataEntry.startAngle}\n        title={dataEntry.title}\n        style={Object.assign(\n          {},\n          segmentsStyle,\n          props.animate &&\n            combineSegmentTransitionsStyle(\n              props.animationDuration,\n              props.animationEasing,\n              segmentsStyle\n            )\n        )}\n        stroke={dataEntry.color}\n        tabIndex={props.segmentsTabIndex}\n        onBlur={makeEventHandler(props.onBlur, index)}\n        onClick={makeEventHandler(props.onClick, index)}\n        onFocus={makeEventHandler(props.onFocus, index)}\n        onKeyDown={makeEventHandler(props.onKeyDown, index)}\n        onMouseOver={makeEventHandler(props.onMouseOver, index)}\n        onMouseOut={makeEventHandler(props.onMouseOut, index)}\n      />\n    );\n  });\n\n  if (props.background) {\n    paths.unshift(\n      <Path\n        cx={cx}\n        cy={cy}\n        key=\"bg\"\n        lengthAngle={props.lengthAngle}\n        lineWidth={lineWidth}\n        radius={radius}\n        rounded={props.rounded}\n        startAngle={props.startAngle}\n        stroke={props.background}\n      />\n    );\n  }\n\n  return paths;\n}\n","import React, { useState, useEffect } from 'react';\nimport type {\n  CSSProperties,\n  FocusEvent,\n  KeyboardEvent,\n  MouseEvent,\n  ReactNode,\n} from 'react';\nimport extendData from './extendData';\nimport renderLabels from './renderLabels';\nimport renderSegments from './renderSegments';\nimport type { Data, EventHandler, LabelRenderFunction } from '../commonTypes';\n\ntype Props = {\n  animate?: boolean;\n  animationDuration?: number;\n  animationEasing?: string;\n  background?: string;\n  center?: [number, number];\n  children?: ReactNode;\n  className?: string;\n  data: Data;\n  lengthAngle?: number;\n  lineWidth?: number;\n  label?: LabelRenderFunction;\n  labelPosition?: number;\n  labelStyle?:\n    | CSSProperties\n    | ((dataIndex: number) => CSSProperties | undefined);\n  onBlur?: EventHandler<FocusEvent>;\n  onClick?: EventHandler<MouseEvent>;\n  onFocus?: EventHandler<FocusEvent>;\n  onKeyDown?: EventHandler<KeyboardEvent>;\n  onMouseOut?: EventHandler<MouseEvent>;\n  onMouseOver?: EventHandler<MouseEvent>;\n  paddingAngle?: number;\n  radius?: number;\n  reveal?: number;\n  rounded?: boolean;\n  segmentsShift?: number | ((dataIndex: number) => number | undefined);\n  segmentsStyle?:\n    | CSSProperties\n    | ((dataIndex: number) => CSSProperties | undefined);\n  segmentsTabIndex?: number;\n  startAngle?: number;\n  style?: CSSProperties;\n  totalValue?: number;\n  viewBoxSize?: [number, number];\n};\n\nconst defaultProps = {\n  animationDuration: 500,\n  animationEasing: 'ease-out',\n  center: [50, 50] as [number, number],\n  data: [] as Data,\n  labelPosition: 50,\n  lengthAngle: 360,\n  lineWidth: 100,\n  paddingAngle: 0,\n  radius: 50,\n  startAngle: 0,\n  viewBoxSize: [100, 100] as [number, number],\n};\n\nexport type PropsWithDefaults = Props & typeof defaultProps;\n\nexport function ReactMinimalPieChart(props: PropsWithDefaults) {\n  const [revealOverride, setRevealOverride] = useState(\n    props.animate ? 0 : null\n  );\n  useEffect(() => {\n    if (props.animate) {\n      return startInitialAnimation();\n    }\n\n    function startInitialAnimation() {\n      let animationTimerId: NodeJS.Timeout | null;\n      let animationRAFId: number | null;\n      animationTimerId = setTimeout(() => {\n        animationTimerId = null;\n        animationRAFId = requestAnimationFrame(() => {\n          animationRAFId = null;\n          setRevealOverride(null); // Start animation\n        });\n      });\n\n      return () => {\n        animationTimerId && clearTimeout(animationTimerId);\n        animationRAFId && cancelAnimationFrame(animationRAFId);\n      };\n    }\n  }, []);\n\n  const extendedData = extendData(props);\n  return (\n    <svg\n      viewBox={`0 0 ${props.viewBoxSize[0]} ${props.viewBoxSize[1]}`}\n      width=\"100%\"\n      height=\"100%\"\n      className={props.className}\n      style={props.style}\n    >\n      {renderSegments(extendedData, props, revealOverride)}\n      {props.label && renderLabels(extendedData, props)}\n      {props.children}\n    </svg>\n  );\n}\n\nReactMinimalPieChart.defaultProps = defaultProps;\n"],"names":["degreesToRadians","degrees","Math","PI","valueBetween","value","min","max","extractPercentage","percentage","bisectorAngle","startAngle","lengthAngle","shiftVectorAlongAngle","angle","distance","angleRadians","dx","cos","dy","sin","isNumber","functionProp","prop","payload","sumValues","data","sum","i","length","extendData","totalAngle","totalValue","paddingAngle","chartStartAngle","total","normalizedTotalAngle","numberOfPaddings","abs","singlePaddingDegrees","sign","degreesTakenByPadding","degreesTakenByPaths","lastSegmentEnd","extendedData","dataEntry","valueInPercentage","push","Object","assign","ReactMinimalPieChartLabel","dataIndex","props","React","round","number","divisor","Number","EPSILON","evaluateTextAnchorPosition","labelPosition","lineWidth","labelHorizontalShift","innerRadius","renderLabelElement","renderLabel","labelProps","label","DefaultLabel","key","isValidElement","renderLabels","map","index","segmentsShift","distanceFromCenter","radius","labelRenderProps","x","center","y","textAnchor","style","labelStyle","partialCircle","cx","cy","r","start","end","fromX","fromY","toX","toY","large","sweep","module","makePathCommands","patchedLengthAngle","command","join","ReactMinimalPieChartPath","shift","reveal","rounded","title","pathRadius","pathCommands","strokeDasharray","strokeDashoffset","pathLength","undefined","combineSegmentTransitionsStyle","duration","easing","customStyle","transition","getRevealValue","animate","makeEventHandler","eventHandler","e","renderSegments","revealOverride","paths","segmentsStyle","Path","animationDuration","animationEasing","color","segmentsTabIndex","onBlur","onClick","onFocus","onKeyDown","onMouseOver","onMouseOut","background","unshift","defaultProps","viewBoxSize","ReactMinimalPieChart","useState","setRevealOverride","useEffect","startInitialAnimation","animationTimerId","animationRAFId","setTimeout","requestAnimationFrame","clearTimeout","cancelAnimationFrame","className","children"],"mappings":"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"}